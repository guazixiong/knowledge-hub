# ğŸ§  ä¼ä¸šçº§çŸ¥è¯†ä¸­å° - LangChain + Dify è§£å†³æ–¹æ¡ˆ

[![Python](https://img.shields.io/badge/Python-3.10+-blue.svg)](https://www.python.org/downloads/)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.104+-green.svg)](https://fastapi.tiangolo.com/)
[![LangChain](https://img.shields.io/badge/LangChain-0.1+-orange.svg)](https://langchain.com/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

ä¸€ä¸ªåŸºäº LangChain å’Œ Dify çš„ä¼ä¸šçº§çŸ¥è¯†ä¸­å°è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒå¤šçŸ¥è¯†åº“ç®¡ç†ã€æ™ºèƒ½æ–‡æ¡£å¤„ç†å’Œè¯­ä¹‰æ£€ç´¢ã€‚

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

### ğŸ—ï¸ ä¼ä¸šçº§æ¶æ„
- **è§£è€¦è®¾è®¡**ï¼šæ•°æ®ä¸­å°ä½œä¸ºä¸­é—´å±‚ï¼ŒDify å’Œ LangChain é€šè¿‡æ ‡å‡† API é€šä¿¡
- **çŸ¥è¯†åº“éš”ç¦»**ï¼šæ¯ä¸ªé¡¹ç›®/ç³»ç»Ÿç‹¬ç«‹çŸ¥è¯†åº“ï¼Œäº’ä¸å¹²æ‰°
- **æ•°æ®æŒä¹…åŒ–**ï¼šå‘é‡æ•°æ®å­˜å‚¨åœ¨ç£ç›˜ï¼Œæ”¯æŒå¤‡ä»½ä¸è¿ç§»
- **å¯æ‰©å±•æ€§**ï¼šæ”¯æŒä»å•æœºåˆ°åˆ†å¸ƒå¼çš„å¹³æ»‘å‡çº§

### ğŸ“„ æ™ºèƒ½æ–‡æ¡£å¤„ç†
- **å¤šæ ¼å¼æ”¯æŒ**ï¼šæ”¯æŒ .txtã€.mdã€.docxã€.pdfã€.htmlã€.pptx ç­‰ä¸»æµæ ¼å¼
- **æ™ºèƒ½åˆ†å—**ï¼šåŸºäº RecursiveCharacterTextSplitter çš„è¯­ä¹‰åˆ†å—
- **å…ƒæ•°æ®æå–**ï¼šè‡ªåŠ¨æå–æ–‡æ¡£ç‰ˆæœ¬ã€ç³»ç»Ÿã€ç±»å‹ç­‰å…ƒä¿¡æ¯
- **æ‰¹é‡å¤„ç†**ï¼šæ”¯æŒæ–‡æ¡£æ‰¹é‡ä¸Šä¼ å’Œå¼‚æ­¥å¤„ç†

### ğŸ” é«˜æ•ˆæ£€ç´¢ç³»ç»Ÿ
- **è¯­ä¹‰æ£€ç´¢**ï¼šåŸºäº OpenAI Embeddings çš„å‘é‡ç›¸ä¼¼åº¦åŒ¹é…
- **å¤šçŸ¥è¯†åº“æ£€ç´¢**ï¼šæ”¯æŒè·¨çŸ¥è¯†åº“è”åˆæ£€ç´¢
- **è¿‡æ»¤æŸ¥è¯¢**ï¼šåŸºäºå…ƒæ•°æ®çš„ç²¾ç¡®è¿‡æ»¤
- **ç›¸ä¼¼åº¦è¯„åˆ†**ï¼šæä¾›æ£€ç´¢ç»“æœçš„ç›¸å…³æ€§è¯„åˆ†

### ğŸ’¾ çµæ´»å­˜å‚¨æ–¹æ¡ˆ
- **å°è§„æ¨¡**ï¼šChromaDB (< 10ä¸‡æ¡) - è½»é‡çº§ï¼Œé›¶é…ç½®
- **ä¸­ç­‰è§„æ¨¡**ï¼šQdrant (10-100ä¸‡æ¡) - é«˜æ€§èƒ½ï¼Œæ”¯æŒè¿‡æ»¤
- **å¤§è§„æ¨¡**ï¼šMilvus (> 100ä¸‡æ¡) - åˆ†å¸ƒå¼ï¼Œä¼ä¸šçº§

## ğŸ›ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          æ•°æ®ä¸­å°å‰ç«¯ï¼ˆç®¡ç†ç•Œé¢ï¼‰              â”‚
â”‚  â€¢ å¤šçŸ¥è¯†åº“åˆ‡æ¢ä¸ç®¡ç†                         â”‚
â”‚  â€¢ æ–‡æ¡£æ‰¹é‡ä¸Šä¼                                â”‚
â”‚  â€¢ å‘é‡æ•°æ®ç›‘æ§                               â”‚
â”‚  â€¢ æ£€ç´¢æ•ˆæœæµ‹è¯•                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ HTTP API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          æ•°æ®ä¸­å°åç«¯ï¼ˆFastAPIï¼‰              â”‚
â”‚  â€¢ çŸ¥è¯†åº“ CRUD æ¥å£                          â”‚
â”‚  â€¢ æ–‡æ¡£ä¸Šä¼ ä¸å¤„ç†è°ƒåº¦                         â”‚
â”‚  â€¢ ç»Ÿä¸€æ£€ç´¢æ¥å£ï¼ˆä¾› Dify è°ƒç”¨ï¼‰               â”‚
â”‚  â€¢ ä»»åŠ¡é˜Ÿåˆ—ä¸çŠ¶æ€ç®¡ç†                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          LangChain å¤„ç†å±‚                    â”‚
â”‚  â€¢ Unstructured å¤šæ ¼å¼æ–‡æ¡£è§£æ                â”‚
â”‚  â€¢ RecursiveCharacterTextSplitter æ™ºèƒ½åˆ†å—   â”‚
â”‚  â€¢ Embedding å‘é‡åŒ–ï¼ˆOpenAI/æœ¬åœ°æ¨¡å‹ï¼‰        â”‚
â”‚  â€¢ Metadata è‡ªåŠ¨æå–ä¸ç®¡ç†                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       å‘é‡æ•°æ®åº“ï¼ˆæŒä¹…åŒ–å­˜å‚¨ï¼‰                 â”‚
â”‚  â€¢ å°è§„æ¨¡ï¼šChromaDB (PersistentClient)       â”‚
â”‚  â€¢ å¤§è§„æ¨¡ï¼šMilvus / Qdrant                   â”‚
â”‚  â€¢ æŒ‰çŸ¥è¯†åº“éš”ç¦»ï¼š./dbs/{kb_name}/            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

           â†‘ æ£€ç´¢ API
           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Dify        â”‚
â”‚  â€¢ é€šè¿‡ API å·¥å…·   â”‚
â”‚    è°ƒç”¨æ•°æ®ä¸­å°     â”‚
â”‚  â€¢ æ•´åˆæ£€ç´¢ç»“æœ     â”‚
â”‚  â€¢ ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.10+
- Node.js 16+ (å‰ç«¯å¼€å‘)
- OpenAI API Key (æˆ–æœ¬åœ° Embedding æ¨¡å‹)

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/your-org/knowledge-hub.git
cd knowledge-hub
```

2. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ**

3. **å®‰è£…åç«¯ä¾èµ–**

4. **å®‰è£…å‰ç«¯ä¾èµ–**

5. **é…ç½®ç¯å¢ƒå˜é‡**

6. **éƒ¨ç½² MinIO å¯¹è±¡å­˜å‚¨**

**ä½¿ç”¨ Docker éƒ¨ç½² MinIO (æ¨è)ï¼š**
```bash
# åˆ›å»º MinIO æ•°æ®ç›®å½•
mkdir -p ./data/minio/{data,config}

# å¯åŠ¨ MinIO æœåŠ¡
docker run -d \
  --name minio-server \
  -p 9000:9000 \
  -p 9001:9001 \
  -e "MINIO_ROOT_USER=minioadmin" \
  -e "MINIO_ROOT_PASSWORD=minioadmin123" \
  -v ./data/minio/data:/data \
  -v ./data/minio/config:/root/.minio \
  minio/minio server /data --console-address ":9001"

# éªŒè¯ MinIO æœåŠ¡
curl http://localhost:9000/minio/health/live
```

**ä½¿ç”¨ Docker Compose éƒ¨ç½²ï¼š**
```bash
# åˆ›å»º docker-compose.minio.yml æ–‡ä»¶ï¼ˆå‚è€ƒå®æ–½æ–¹æ¡ˆæ–‡æ¡£ï¼‰
docker-compose -f docker-compose.minio.yml up -d
```

**è®¿é—® MinIOï¼š**
- API ç«¯ç‚¹ï¼šhttp://localhost:9000
- Web æ§åˆ¶å°ï¼šhttp://localhost:9001
- é»˜è®¤è´¦å·ï¼šminioadmin / minioadmin123

7. **å¯åŠ¨æœåŠ¡**

åç«¯æœåŠ¡ï¼š

å‰ç«¯æœåŠ¡ï¼š

8. **è®¿é—®ç³»ç»Ÿ**
- ç®¡ç†ç•Œé¢ï¼šhttp://localhost:3000
- API æ–‡æ¡£ï¼šhttp://localhost:8000/docs
- MinIO æ§åˆ¶å°ï¼šhttp://localhost:9001

## ğŸ“ é¡¹ç›®ç»“æ„

```

```

## ğŸ“š ç›¸å…³æ–‡æ¡£

æœ¬é¡¹ç›®æä¾›äº†å®Œæ•´çš„æŠ€æœ¯æ–‡æ¡£å’Œå®æ–½æŒ‡å—ï¼Œå¸®åŠ©æ‚¨æ·±å…¥äº†è§£ç³»ç»Ÿæ¶æ„å’Œå®æ–½ç»†èŠ‚ï¼š

### ğŸ“– æ ¸å¿ƒæ–‡æ¡£

| æ–‡æ¡£åç§° | æè¿° | é“¾æ¥ |
|---------|------|------|
| ğŸ—ï¸ **æ¶æ„è®¾è®¡æ–‡æ¡£** | è¯¦ç»†çš„ç³»ç»Ÿæ¶æ„è®¾è®¡ã€æŠ€æœ¯é€‰å‹å’Œæ ¸å¿ƒè®¾è®¡åŸåˆ™ | [LangChain + Dify ä¼ä¸šçº§çŸ¥è¯†ä¸­å°æ¶æ„è®¾è®¡æ–‡æ¡£](./docs/LangChain%20+%20Dify%20ä¼ä¸šçº§çŸ¥è¯†ä¸­å°æ¶æ„è®¾è®¡æ–‡æ¡£.md) |
| ğŸš€ **å®æ–½æ–¹æ¡ˆä¸éªŒæ”¶æ ‡å‡†** | å®Œæ•´çš„é¡¹ç›®å®æ–½è®¡åˆ’ã€ä»»åŠ¡åˆ†è§£å’ŒéªŒæ”¶æ ‡å‡† | [ä¼ä¸šçº§çŸ¥è¯†ä¸­å°å®æ–½æ–¹æ¡ˆä¸éªŒæ”¶æ ‡å‡†](./docs/ä¼ä¸šçº§çŸ¥è¯†ä¸­å°å®æ–½æ–¹æ¡ˆä¸éªŒæ”¶æ ‡å‡†.md) |
| ğŸ“‹ **å®Œæ•´å®æ–½æŒ‡å—** | ä»é›¶å¼€å§‹çš„è¯¦ç»†å®æ–½æ­¥éª¤å’Œä»£ç ç¤ºä¾‹ | [ä¼ä¸šçº§çŸ¥è¯†ä¸­å°å®Œæ•´å®æ–½æŒ‡å—](./docs/ä¼ä¸šçº§çŸ¥è¯†ä¸­å°å®Œæ•´å®æ–½æŒ‡å—.md) |

### ğŸ“ æ–‡æ¡£è¯´æ˜

- **æ¶æ„è®¾è®¡æ–‡æ¡£**ï¼šåŒ…å«ç³»ç»Ÿæ•´ä½“æ¶æ„å›¾ã€æŠ€æœ¯æ ˆé€‰æ‹©ã€æ•°æ®æµè®¾è®¡ã€å®‰å…¨ç­–ç•¥ç­‰æ ¸å¿ƒè®¾è®¡å†…å®¹
- **å®æ–½æ–¹æ¡ˆä¸éªŒæ”¶æ ‡å‡†**ï¼šæä¾›8ä¸ªé˜¶æ®µçš„è¯¦ç»†å®æ–½è®¡åˆ’ï¼ŒåŒ…å«ä»»åŠ¡æ¸…å•ã€ä»£ç ç¤ºä¾‹å’ŒéªŒæ”¶æ ‡å‡†
- **å®Œæ•´å®æ–½æŒ‡å—**ï¼šæä¾›ä»ç¯å¢ƒæ­å»ºåˆ°éƒ¨ç½²ä¸Šçº¿çš„å®Œæ•´æ“ä½œæ­¥éª¤ï¼Œé€‚åˆå¼€å‘å›¢é˜Ÿå‚è€ƒ

### ğŸ¯ ä½¿ç”¨å»ºè®®

1. **é¡¹ç›®å¯åŠ¨å‰**ï¼šå…ˆé˜…è¯»æ¶æ„è®¾è®¡æ–‡æ¡£ï¼Œäº†è§£æ•´ä½“æŠ€æœ¯æ–¹æ¡ˆ
2. **å¼€å‘é˜¶æ®µ**ï¼šå‚è€ƒå®æ–½æ–¹æ¡ˆä¸éªŒæ”¶æ ‡å‡†ï¼ŒæŒ‰é˜¶æ®µæ¨è¿›é¡¹ç›®
3. **å…·ä½“å®æ–½**ï¼šä½¿ç”¨å®Œæ•´å®æ–½æŒ‡å—ä¸­çš„ä»£ç ç¤ºä¾‹å’Œæ“ä½œæ­¥éª¤

è¿™äº›æ–‡æ¡£å°†å¸®åŠ©æ‚¨ï¼š
- ğŸ¯ å¿«é€Ÿç†è§£é¡¹ç›®æ¶æ„å’ŒæŠ€æœ¯é€‰å‹
- ğŸ“‹ åˆ¶å®šè¯¦ç»†çš„é¡¹ç›®å®æ–½è®¡åˆ’
- ğŸ’» è·å¾—å®Œæ•´çš„ä»£ç ç¤ºä¾‹å’Œæœ€ä½³å®è·µ
- âœ… å»ºç«‹æ˜ç¡®çš„éªŒæ”¶æ ‡å‡†å’Œè´¨é‡æ§åˆ¶

## ğŸ”§ æ ¸å¿ƒ API

### çŸ¥è¯†åº“ç®¡ç†
```http
POST   /api/kb/create                    # åˆ›å»ºçŸ¥è¯†åº“
GET    /api/kb/list                      # è·å–çŸ¥è¯†åº“åˆ—è¡¨
GET    /api/kb/{kb_id}/info              # è·å–çŸ¥è¯†åº“è¯¦æƒ…
PUT    /api/kb/{kb_id}/update            # æ›´æ–°çŸ¥è¯†åº“é…ç½®
DELETE /api/kb/{kb_id}                   # åˆ é™¤çŸ¥è¯†åº“
```

### æ–‡æ¡£ç®¡ç†
```http
POST   /api/kb/{kb_id}/documents/upload  # ä¸Šä¼ æ–‡æ¡£ï¼ˆæ”¯æŒæ‰¹é‡ï¼‰
GET    /api/kb/{kb_id}/documents         # è·å–æ–‡æ¡£åˆ—è¡¨
GET    /api/kb/{kb_id}/documents/{doc_id} # è·å–æ–‡æ¡£è¯¦æƒ…
DELETE /api/kb/{kb_id}/documents/{doc_id} # åˆ é™¤æ–‡æ¡£
```

### æ–‡ä»¶å­˜å‚¨ç®¡ç†ï¼ˆMinIOï¼‰
```http
POST   /api/files/upload                 # ä¸Šä¼ æ–‡ä»¶åˆ° MinIO
GET    /api/files/{file_id}/download      # ä¸‹è½½æ–‡ä»¶
GET    /api/files/{file_id}/url           # è·å–æ–‡ä»¶é¢„ç­¾å URL
DELETE /api/files/{file_id}               # åˆ é™¤æ–‡ä»¶
GET    /api/files/list                    # è·å–æ–‡ä»¶åˆ—è¡¨
```

### æ£€ç´¢æ¥å£ï¼ˆä¾› Dify è°ƒç”¨ï¼‰
```http
POST   /api/retrieve                     # è¯­ä¹‰æ£€ç´¢
POST   /api/retrieve/multi               # å¤šçŸ¥è¯†åº“è”åˆæ£€ç´¢
```

### ä½¿ç”¨ç¤ºä¾‹

**åˆ›å»ºçŸ¥è¯†åº“ï¼š**

```bash
curl -X POST "http://localhost:8000/api/kb/create" \
     -H "Content-Type: application/json" \
     -d '{
       "kb_id": "crm_system",
       "kb_name": "CRMç³»ç»ŸçŸ¥è¯†åº“",
       "embedding_model": "text-embedding-3-small"
     }'
```

**è¯­ä¹‰æ£€ç´¢ï¼š**
```bash
curl -X POST "http://localhost:8000/api/retrieve" \
     -H "Content-Type: application/json" \
     -d '{
       "query": "å¦‚ä½•é…ç½®ç”¨æˆ·æƒé™",
       "kb_id": "crm_system",
       "top_k": 5,
       "min_score": 0.6
     }'
```

**æ–‡ä»¶ä¸Šä¼ åˆ° MinIOï¼š**
```bash
curl -X POST "http://localhost:8000/api/files/upload" \
     -H "Content-Type: multipart/form-data" \
     -F "file=@/path/to/document.pdf" \
     -F "kb_id=crm_system"
```

**è·å–æ–‡ä»¶é¢„ç­¾å URLï¼š**
```bash
curl -X GET "http://localhost:8000/api/files/file123/url?expires=3600"
```

## ğŸ“‹ æ”¯æŒçš„æ–‡æ¡£ç±»å‹

| æ–‡æ¡£ç±»å‹        | æ”¯æŒç¨‹åº¦             | è¯´æ˜                         |
| --------------- | -------------------- | ---------------------------- |
| .txt            | âœ… å®Œå…¨æ”¯æŒ           | æœ€æ¨èï¼Œè§£æç®€å•ç¨³å®š         |
| .mdï¼ˆMarkdownï¼‰ | âœ… å®Œå…¨æ”¯æŒ           | èƒ½ä¿ç•™æ ‡é¢˜å±‚çº§ç»“æ„           |
| .doc / .docx    | âœ… å®Œå…¨æ”¯æŒ           | Word æ–‡æ¡£å¯ä»¥è§£ææ®µè½å’Œæ ‡é¢˜  |
| .pdf            | âœ… æ”¯æŒï¼ˆå»ºè®®æ–‡å­—ç‰ˆï¼‰ | å›¾ç‰‡å‹ PDF éœ€ OCR æ‰èƒ½è¯†åˆ«   |
| .html / .htm    | âœ… å®Œå…¨æ”¯æŒ           | é€‚åˆå­˜ç½‘é¡µå†…å®¹               |
| .pptx           | âœ… æ”¯æŒ               | ä¼šæå–å¹»ç¯ç‰‡æ–‡å­—å†…å®¹         |
| .csv / .xlsx    | âš ï¸ å¯é€‰æ”¯æŒ           | å†…å®¹æ˜¯ç»“æ„åŒ–è¡¨æ ¼ï¼Œè¯­ä¹‰ä»·å€¼ä½ |
| .png / .jpg     | âš ï¸ éœ€ OCR             | éœ€å®‰è£… Tesseract ç­‰ä¾èµ–      |

## ğŸ”§ é…ç½®è¯´æ˜

### çŸ¥è¯†åº“é…ç½®ç¤ºä¾‹

```json
{
  "kb_id": "crm_system",
  "kb_name": "CRMç³»ç»ŸçŸ¥è¯†åº“",
  "description": "åŒ…å«CRMç³»ç»Ÿçš„éœ€æ±‚ã€è®¾è®¡ã€è¿ç»´æ–‡æ¡£",
  "created_at": "2025-01-30",
  "embedding_model": "text-embedding-3-small",
  "chunk_size": 1000,
  "chunk_overlap": 200,
  "db_type": "chromadb",
  "db_path": "./knowledge_bases/crm_system/db",
  "allowed_doc_types": [".docx", ".pdf", ".md", ".txt"],
  "auto_extract_metadata": true,
  "metadata_fields": ["system", "doc_type", "version", "module"]
}
```

### ç¯å¢ƒå˜é‡é…ç½®

```bash
# OpenAI é…ç½®
OPENAI_API_KEY=your_openai_api_key
EMBEDDING_MODEL=text-embedding-3-small

# æ•°æ®åº“é…ç½®
DB_TYPE=chromadb
DB_PATH=./knowledge_bases

# MinIO å¯¹è±¡å­˜å‚¨é…ç½®
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin123
MINIO_BUCKET=knowledge-hub-docs
MINIO_SECURE=false

# æœåŠ¡é…ç½®
API_HOST=0.0.0.0
API_PORT=8000
FRONTEND_URL=http://localhost:3000

# æ–‡æ¡£å¤„ç†é…ç½®
MAX_FILE_SIZE=50MB
CHUNK_SIZE=1000
CHUNK_OVERLAP=200
```

## ğŸ¤ ä¸ Dify é›†æˆ

### åœ¨ Dify ä¸­é…ç½® API å·¥å…·

1. **æ·»åŠ  API å·¥å…·**
   - å·¥å…·åç§°ï¼šKnowledge Retrieval
   - API ç«¯ç‚¹ï¼šhttp://your-domain:8000/api/retrieve
   - æ–¹æ³•ï¼šPOST

2. **é…ç½®å‚æ•°**
```json
{
  "query": "{{query}}",
  "kb_id": "crm_system",
  "top_k": 5,
  "min_score": 0.6
}
```

3. **åœ¨å·¥ä½œæµä¸­ä½¿ç”¨**
   - ç”¨æˆ·è¾“å…¥ â†’ Knowledge Retrieval â†’ LLM ç”Ÿæˆç­”æ¡ˆ

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# å®‰è£…æµ‹è¯•ä¾èµ–
pip install pytest pytest-asyncio httpx

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•
pytest tests/test_api.py -v
```

### API æµ‹è¯•ç¤ºä¾‹

```python
import httpx

async def test_create_kb():
    async with httpx.AsyncClient() as client:
        response = await client.post(
            "http://localhost:8000/api/kb/create",
            json={
                "kb_id": "test_kb",
                "kb_name": "æµ‹è¯•çŸ¥è¯†åº“"
            }
        )
        assert response.status_code == 200
```

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: æ£€ç´¢ç»“æœä¸å‡†ç¡®ï¼Ÿ**
A: è°ƒæ•´ chunk_size å’Œ embedding æ¨¡å‹ï¼Œä¼˜åŒ–æ–‡æ¡£å†…å®¹è´¨é‡ã€‚

**Q: æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Ÿ**
A: ç¡®è®¤æ•°æ®åº“è·¯å¾„æƒé™ï¼Œæ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®ã€‚

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f logs/app.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f logs/error.log
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯

## ğŸ“ è”ç³»æˆ‘ä»¬

- é¡¹ç›®ä¸»é¡µï¼šhttps://github.com/guazixiong/knowledge-hub
- é—®é¢˜åé¦ˆï¼šhttps://github.com/guazixiong/knowledge-hub/issues
- é‚®ç®±ï¼špbad0606@163.com

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š
- [LangChain](https://langchain.com/) - å¼ºå¤§çš„ LLM åº”ç”¨æ¡†æ¶
- [FastAPI](https://fastapi.tiangolo.com/) - ç°ä»£åŒ–çš„ Python Web æ¡†æ¶
- [ChromaDB](https://www.trychroma.com/) - å¼€æºå‘é‡æ•°æ®åº“
- [Unstructured](https://unstructured.io/) - æ–‡æ¡£è§£æå·¥å…·

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª Starï¼
